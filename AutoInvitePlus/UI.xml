<Ui xmlns="http://www.blizzard.com/wow/ui" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <!-- Main Configuration Frame -->
  <Frame name="AIPMainFrame" hidden="true" movable="true" enableMouse="true" parent="UIParent" frameStrata="DIALOG">
    <Size>
      <AbsDimension x="400" y="520"/>
    </Size>
    <Anchors>
      <Anchor point="CENTER"/>
    </Anchors>
    <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="11" right="12" top="12" bottom="11"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="32"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>

    <Layers>
      <Layer level="ARTWORK">
        <!-- Title -->
        <Texture name="$parentTitleBorder" file="Interface\DialogFrame\UI-DialogBox-Header">
          <Size>
            <AbsDimension x="200" y="64"/>
          </Size>
          <Anchors>
            <Anchor point="TOP">
              <Offset>
                <AbsDimension x="0" y="12"/>
              </Offset>
            </Anchor>
          </Anchors>
          <TexCoords left="0.2" right="0.8" top="0" bottom="0.6"/>
        </Texture>
        <FontString name="$parentTitle" inherits="GameFontNormal" text="AutoInvite Plus">
          <Anchors>
            <Anchor point="TOP">
              <Offset>
                <AbsDimension x="0" y="-2"/>
              </Offset>
            </Anchor>
          </Anchors>
        </FontString>
      </Layer>
    </Layers>

    <Frames>
      <!-- Close Button -->
      <Button name="$parentCloseButton" inherits="UIPanelCloseButton">
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset>
              <AbsDimension x="-5" y="-5"/>
            </Offset>
          </Anchor>
        </Anchors>
      </Button>

      <!-- Enable Checkbox -->
      <CheckButton name="AIPEnableCheck" inherits="UICheckButtonTemplate">
        <Size>
          <AbsDimension x="26" y="26"/>
        </Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="20" y="-35"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>
            AutoInvitePlus.db.enabled = self:GetChecked()
            AutoInvitePlus.Print("Auto-invite " .. (AutoInvitePlus.db.enabled and "ENABLED" or "DISABLED"))
          </OnClick>
        </Scripts>
      </CheckButton>
      <Frame name="AIPEnableLabel">
        <Size>
          <AbsDimension x="150" y="20"/>
        </Size>
        <Anchors>
          <Anchor point="LEFT" relativeTo="AIPEnableCheck" relativePoint="RIGHT">
            <Offset>
              <AbsDimension x="5" y="0"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Layers>
          <Layer level="OVERLAY">
            <FontString inherits="GameFontNormalLarge" text="Enable Auto-Invite">
              <Anchors>
                <Anchor point="LEFT"/>
              </Anchors>
            </FontString>
          </Layer>
        </Layers>
      </Frame>

      <!-- Trigger Keywords -->
      <Frame name="AIPTriggersLabel">
        <Size>
          <AbsDimension x="100" y="20"/>
        </Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="25" y="-70"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Layers>
          <Layer level="OVERLAY">
            <FontString inherits="GameFontNormal" text="Trigger Keywords:">
              <Anchors>
                <Anchor point="LEFT"/>
              </Anchors>
            </FontString>
          </Layer>
        </Layers>
      </Frame>
      <EditBox name="AIPTriggersInput" inherits="InputBoxTemplate" autoFocus="false">
        <Size>
          <AbsDimension x="230" y="20"/>
        </Size>
        <Anchors>
          <Anchor point="LEFT" relativeTo="AIPTriggersLabel" relativePoint="RIGHT">
            <Offset>
              <AbsDimension x="10" y="0"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnEnterPressed>
            AutoInvitePlus.db.triggers = self:GetText()
            self:ClearFocus()
          </OnEnterPressed>
          <OnEscapePressed>
            self:SetText(AutoInvitePlus.db.triggers or "")
            self:ClearFocus()
          </OnEscapePressed>
        </Scripts>
      </EditBox>
      <Frame name="AIPTriggersHelp">
        <Size>
          <AbsDimension x="350" y="15"/>
        </Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="25" y="-90"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Layers>
          <Layer level="OVERLAY">
            <FontString inherits="GameFontNormalSmall" text="(Separate multiple keywords with semicolons, e.g.: inv;invite;123)">
              <Anchors>
                <Anchor point="LEFT"/>
              </Anchors>
              <Color r="0.7" g="0.7" b="0.7"/>
            </FontString>
          </Layer>
        </Layers>
      </Frame>

      <!-- Listen Channels Section -->
      <Frame name="AIPListenHeader">
        <Size>
          <AbsDimension x="200" y="20"/>
        </Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="20" y="-115"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Layers>
          <Layer level="OVERLAY">
            <FontString inherits="GameFontNormal" text="Listen for triggers in:">
              <Anchors>
                <Anchor point="LEFT"/>
              </Anchors>
              <Color r="1" g="0.82" b="0"/>
            </FontString>
          </Layer>
        </Layers>
      </Frame>

      <!-- Listen checkboxes - Row 1 -->
      <CheckButton name="AIPListenWhisper" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="25" y="-135"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenWhisper = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="70" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenWhisper" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Whisper"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenGuild" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="115" y="-135"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenGuild = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="50" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenGuild" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Guild"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenSay" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="195" y="-135"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenSay = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="40" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenSay" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Say"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenYell" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="265" y="-135"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenYell = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="40" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenYell" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Yell"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <!-- Listen checkboxes - Row 2 -->
      <CheckButton name="AIPListenGeneral" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="25" y="-157"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenGeneral = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="70" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenGeneral" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="General"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenTrade" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="115" y="-157"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenTrade = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="50" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenTrade" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Trade"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenLFG" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="195" y="-157"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenLFG = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="40" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenLFG" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="LFG"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPListenDefense" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset><AbsDimension x="265" y="-157"/></Offset>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>AutoInvitePlus.db.listenDefense = self:GetChecked()</OnClick>
        </Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="60" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPListenDefense" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Defense"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <!-- Options Section -->
      <Frame name="AIPOptionsHeader">
        <Size><AbsDimension x="200" y="20"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-190"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormal" text="Options:"><Anchors><Anchor point="LEFT"/></Anchors><Color r="1" g="0.82" b="0"/></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPGuildOnly" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="25" y="-210"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.guildOnly = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="150" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPGuildOnly" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Guild members only"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPAutoRaid" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="200" y="-210"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.autoRaid = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="150" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPAutoRaid" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Auto-convert to raid"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPUseQueue" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="25" y="-232"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.useQueue = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="180" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPUseQueue" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Use queue (review before invite)"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <!-- Max Raiders -->
      <CheckButton name="AIPUseMaxLimit" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="25" y="-254"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.useMaxLimit = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="90" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPUseMaxLimit" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Max raiders:"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>
      <EditBox name="AIPMaxRaidersInput" inherits="InputBoxTemplate" autoFocus="false" numeric="true">
        <Size><AbsDimension x="40" y="20"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="145" y="-254"/></Offset></Anchor></Anchors>
        <Scripts>
          <OnEnterPressed>
            local val = tonumber(self:GetText()) or 25
            if val &lt; 1 then val = 1 end
            if val &gt; 40 then val = 40 end
            AutoInvitePlus.db.maxRaiders = val
            self:SetText(val)
            self:ClearFocus()
          </OnEnterPressed>
          <OnEscapePressed>
            self:SetText(AutoInvitePlus.db.maxRaiders or 25)
            self:ClearFocus()
          </OnEscapePressed>
        </Scripts>
      </EditBox>

      <!-- Spam Message -->
      <Frame name="AIPSpamLabel">
        <Size><AbsDimension x="350" y="20"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-285"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormal" text="Spam Message (use &lt;key&gt; for triggers):"><Anchors><Anchor point="LEFT"/></Anchors><Color r="1" g="0.82" b="0"/></FontString></Layer></Layers>
      </Frame>
      <EditBox name="AIPSpamInput" inherits="InputBoxTemplate" autoFocus="false">
        <Size><AbsDimension x="350" y="20"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="25" y="-305"/></Offset></Anchor></Anchors>
        <Scripts>
          <OnEnterPressed>
            AutoInvitePlus.db.spamMessage = self:GetText()
            self:ClearFocus()
          </OnEnterPressed>
          <OnEscapePressed>
            self:SetText(AutoInvitePlus.db.spamMessage or "")
            self:ClearFocus()
          </OnEscapePressed>
        </Scripts>
      </EditBox>

      <!-- Spam Channels Section -->
      <Frame name="AIPSpamHeader">
        <Size><AbsDimension x="200" y="20"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-335"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormal" text="Spam to channels:"><Anchors><Anchor point="LEFT"/></Anchors><Color r="1" g="0.82" b="0"/></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPSpamGeneral" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="25" y="-355"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.spamGeneral = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="60" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPSpamGeneral" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="General"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPSpamTrade" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="115" y="-355"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.spamTrade = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="50" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPSpamTrade" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Trade"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPSpamGuild" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="195" y="-355"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.spamGuild = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="50" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPSpamGuild" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Guild"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <CheckButton name="AIPSpamSay" inherits="UICheckButtonTemplate">
        <Size><AbsDimension x="22" y="22"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="275" y="-355"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.db.spamSay = self:GetChecked()</OnClick></Scripts>
      </CheckButton>
      <Frame><Size><AbsDimension x="40" y="20"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPSpamSay" relativePoint="RIGHT"><Offset><AbsDimension x="2" y="0"/></Offset></Anchor></Anchors>
        <Layers><Layer level="OVERLAY"><FontString inherits="GameFontNormalSmall" text="Say"><Anchors><Anchor point="LEFT"/></Anchors></FontString></Layer></Layers>
      </Frame>

      <!-- Action Buttons -->
      <Button name="AIPSpamButton" inherits="UIPanelButtonTemplate" text="Spam Now">
        <Size><AbsDimension x="90" y="25"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-390"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.SpamInvite()</OnClick></Scripts>
      </Button>

      <Button name="AIPInviteGuildButton" inherits="UIPanelButtonTemplate" text="Invite Guild">
        <Size><AbsDimension x="90" y="25"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPSpamButton" relativePoint="RIGHT"><Offset><AbsDimension x="10" y="0"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.InviteGuild()</OnClick></Scripts>
      </Button>

      <Button name="AIPInviteFriendsButton" inherits="UIPanelButtonTemplate" text="Invite Friends">
        <Size><AbsDimension x="90" y="25"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPInviteGuildButton" relativePoint="RIGHT"><Offset><AbsDimension x="10" y="0"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.InviteFriends()</OnClick></Scripts>
      </Button>

      <!-- Secondary Buttons -->
      <Button name="AIPQueueButton" inherits="UIPanelButtonTemplate" text="Queue">
        <Size><AbsDimension x="70" y="25"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-425"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.ToggleQueueUI()</OnClick></Scripts>
      </Button>

      <Button name="AIPBlacklistButton" inherits="UIPanelButtonTemplate" text="Blacklist">
        <Size><AbsDimension x="70" y="25"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPQueueButton" relativePoint="RIGHT"><Offset><AbsDimension x="10" y="0"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.ToggleBlacklistUI()</OnClick></Scripts>
      </Button>

      <Button name="AIPPromoteButton" inherits="UIPanelButtonTemplate" text="Promote">
        <Size><AbsDimension x="70" y="25"/></Size>
        <Anchors><Anchor point="LEFT" relativeTo="AIPBlacklistButton" relativePoint="RIGHT"><Offset><AbsDimension x="10" y="0"/></Offset></Anchor></Anchors>
        <Scripts><OnClick>AutoInvitePlus.TogglePromoteUI()</OnClick></Scripts>
      </Button>

      <!-- Status display -->
      <Frame name="AIPStatusFrame">
        <Size><AbsDimension x="350" y="40"/></Size>
        <Anchors><Anchor point="TOPLEFT"><Offset><AbsDimension x="20" y="-460"/></Offset></Anchor></Anchors>
        <Layers>
          <Layer level="OVERLAY">
            <FontString name="AIPStatusText" inherits="GameFontNormalSmall">
              <Anchors><Anchor point="LEFT"/></Anchors>
              <Color r="0.7" g="0.7" b="0.7"/>
            </FontString>
          </Layer>
        </Layers>
      </Frame>

    </Frames>

    <Scripts>
      <OnLoad>
        tinsert(UISpecialFrames, self:GetName())
      </OnLoad>
      <OnShow>
        AutoInvitePlus.UpdateUI()
      </OnShow>
      <OnDragStart>
        self:StartMoving()
      </OnDragStart>
      <OnDragStop>
        self:StopMovingOrSizing()
      </OnDragStop>
    </Scripts>
  </Frame>

  <!-- Lua code for UI functions -->
  <Script>
    -- ToggleUI now routes to CentralGUI if available, otherwise falls back to old UI
    function AutoInvitePlus.ToggleUI()
      if AutoInvitePlus.CentralGUI and AutoInvitePlus.CentralGUI.Toggle then
        AutoInvitePlus.CentralGUI.Toggle()
      else
        -- Fallback to old UI
        if AIPMainFrame:IsVisible() then
          AIPMainFrame:Hide()
        else
          AIPMainFrame:Show()
        end
      end
    end

    -- Toggle old UI explicitly (for backward compatibility)
    function AutoInvitePlus.ToggleOldUI()
      if AIPMainFrame:IsVisible() then
        AIPMainFrame:Hide()
      else
        AIPMainFrame:Show()
      end
    end

    function AutoInvitePlus.UpdateUI()
      if not AutoInvitePlus.db then return end

      local db = AutoInvitePlus.db

      -- Update checkboxes
      AIPEnableCheck:SetChecked(db.enabled)
      AIPListenWhisper:SetChecked(db.listenWhisper)
      AIPListenGuild:SetChecked(db.listenGuild)
      AIPListenSay:SetChecked(db.listenSay)
      AIPListenYell:SetChecked(db.listenYell)
      AIPListenGeneral:SetChecked(db.listenGeneral)
      AIPListenTrade:SetChecked(db.listenTrade)
      AIPListenLFG:SetChecked(db.listenLFG)
      AIPListenDefense:SetChecked(db.listenDefense)
      AIPGuildOnly:SetChecked(db.guildOnly)
      AIPAutoRaid:SetChecked(db.autoRaid)
      AIPUseQueue:SetChecked(db.useQueue)
      AIPUseMaxLimit:SetChecked(db.useMaxLimit)
      AIPSpamGeneral:SetChecked(db.spamGeneral)
      AIPSpamTrade:SetChecked(db.spamTrade)
      AIPSpamGuild:SetChecked(db.spamGuild)
      AIPSpamSay:SetChecked(db.spamSay)

      -- Update edit boxes
      AIPTriggersInput:SetText(db.triggers or "")
      AIPMaxRaidersInput:SetText(db.maxRaiders or 25)
      AIPSpamInput:SetText(db.spamMessage or "")

      -- Update status
      local status = db.enabled and "|cFF00FF00ENABLED|r" or "|cFFFF0000DISABLED|r"
      local groupSize = AutoInvitePlus.GetGroupSize()
      local queueCount = AutoInvitePlus.GetQueueCount and AutoInvitePlus.GetQueueCount() or 0

      AIPStatusText:SetText("Status: " .. status .. "  |  Group: " .. groupSize .. " players  |  Queue: " .. queueCount)
    end
  </Script>

</Ui>
